# FusionAPI
Fusion API for internal and external stakeholders

## Deployment as new instance:

- Git clone the repository
- Go into the folder and rename  file named .env.example to .env change the values 
- Add 
	- WEB_URL="The portal that is going to use the api"
	- API_LOGIN_LINK="The portal login url"
- Make diretcory bootstrap/cache directory
- Make directories storage/framework/cache, storage/framework/sessions, storage/framework/views and make sure they are writable
- Run composer install/update
- Run php artisan key:generate
- Run  php artisan cache:clear
- Run  php artisan view:clear

## API ENDPOINTS
 
### Non - Authenticated Endpoints
<table>
	<thead>
		<tr>
			<td>Endpoint</td>
			<td>Method</td>
			<td>Parameters</td>
			<td>Description</td>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>api/auth/login</td>
			<td>POST</td>
			<td>email, password</td>
			<td>authentication using email and password</td>
		</tr>
		<tr>
			<td>api/auth/reset</td>
			<td>POST</td>
			<td>email, password, password_confirmation, token(from the reset link received in the email)</td>
			<td>Reset password</td>
		</tr>
		<tr>
			<td>api/auth/recovery</td>
			<td>POST</td>
			<td>email</td>
			<td>Recover password through email to reset password</td>
		</tr>
	</tbody>
</table>

### Authenticated Endpoints
<table>
	<thead>
		<tr>
			<td>Endpoint</td>
			<td>Method</td>
			<td>Parameters</td>
			<td>Description</td>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>api/auth/signup</td>
			<td>POST</td>
			<td>name, email, password,role,role_id</td>
			<td>Returns list of orders that needs to be printed.</td>
		</tr>
		<tr>
			<td>api/orders</td>
			<td>GET</td>
			<td></td>
			<td>Returns list of orders that needs to be printed.</td>
		</tr>
		<tr>
			<td>api/order/{order_no}</td>
			<td>GET</td>
			<td></td>
			<td>Returns supplier details of Order, Order status and approved dates.</td>
		</tr>
		<tr>
			<td>api/order/details/{order_no}</td>
			<td>GET</td>
			<td></td>
			<td>Returns details of Packs and Loose cartons and Unit Labels.</td>
		</tr>
		<tr>
			<td>api/order/{order_no}/cartonpack/{item_number?}</td>
			<td>GET</td>
			<td></td>
			<td>Returns label details for Carton Packs of the individual item number - if item_number is passed, if not of the order).</td>
		</tr>
		<tr>
			<td>api/order/{order_no}/cartonloose/{item_number?}</td>
			<td>GET</td>
			<td></td>
			<td>Returns label details for Carton Loose of the individual item number - if item_number is passed, if not of the order).</td>
		</tr>
		<tr>
			<td>api/order/{order_no}/ratiopack</td>
			<td>GET</td>
			<td></td>
			<td>Returns label details for Ratio Packs of the order.</td>
		</tr>
		<tr>
			<td>api/order/{order_no}/simplepack</td>
			<td>GET</td>
			<td></td>
			<td>Returns label details for Simple Packs of the order.</td>
		</tr>
		<tr>
			<td>api/order/{order_no}/looseitem</td>
			<td>GET</td>
			<td></td>
			<td>Returns label details for Loose Items of the order.</td>
		</tr>
		<tr>
			<td>api/order/cartonpack</td>
			<td>POST</td>
			<td>order_no, item_number</td>
			<td>Returns list of carton packs and their details of the individual item number - if item_number is passed, if not of the order).</td>
		</tr>
		<tr>
			<td>api/order/cartonloose</td>
			<td>POST</td>
			<td>order_no, item_number</td>
			<td>Returns list of carton loose and their details of the individual item number - if item_number is passed, if not of the order).</td>
		</tr>
		<tr>
			<td>api/ticket/create/tips/request</td>
			<td>POST</td>
			<td>item, qty, ticket_type, location_type, location, order_no</td>
			<td>Create ticket request with custom quantity and return the ticket object.</td>
		</tr>
		<tr>
			<td>api/tickets</td>
			<td>GET</td>
			<td></td>
			<td>Returns list of all the tickets that has been generated by create endpoint.</td>
		</tr>
		<tr>
			<td>api/ticket/tips/printed</td>
			<td>GET</td>
			<td></td>
			<td>Returns list of all the tickets that has been generated by create endpoint and has been printed.</td>
		</tr>
		<tr>
			<td>api/ticket/tips/{order_no}/{item_number}</td>
			<td>GET</td>
			<td></td>
			<td>Returns label details of the item number of the order.</td>
		</tr>
		<tr>
			<td>api/users/{id?}</td>
			<td>GET</td>
			<td></td>
			<td>Returns list of users and their details.</td>
		</tr>
		<tr>
			<td>api/auth/user</td>
			<td>GET</td>
			<td></td>
			<td>Returns the authenticated user and details.</td>
		</tr>
		<tr>
			<td>api/suppliers</td>
			<td>GET</td>
			<td></td>
			<td>Returns the list of suppliers.</td>
		</tr>
		<tr>
			<td>api/supplier/search/{term}</td>
			<td>GET</td>
			<td></td>
			<td>Returns the supplier details for based on the search term.</td>
		</tr>
	</tbody>
</table>

## Testing 

### Route Endpoint 
PHPUnit Tests are as for each module as Feature
Run phpunit on teh following

- tests/AuthRoutesTest.php
- tests/OrderRoutesTest.php
- tests/SupplierRoutesTest.php
- tests/TicketRoutesTest.php

